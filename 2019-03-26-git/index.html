<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Git 使用指南 - 夜航星</title><meta name="Description" content="做一个智能时代的蛮子"><meta property="og:url" content="https://austinxt.github.io/2019-03-26-git/">
  <meta property="og:site_name" content="夜航星">
  <meta property="og:title" content="Git 使用指南">
  <meta property="og:description" content="Git 是目前世界上最先进的分布式文本文件版本控制系统
Git 快速上手 Cheat Sheet：workspace :: Git Cheatsheet 、常用 Git 命令清单 - 阮一峰的网络日志
Git 使用流程：Git 使用规范流程 - 阮一峰的网络日志">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-04-06T00:00:00+08:00">
    <meta property="article:modified_time" content="2019-04-06T00:00:00+08:00">
    <meta property="article:tag" content="Git">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Git 使用指南">
  <meta name="twitter:description" content="Git 是目前世界上最先进的分布式文本文件版本控制系统
Git 快速上手 Cheat Sheet：workspace :: Git Cheatsheet 、常用 Git 命令清单 - 阮一峰的网络日志
Git 使用流程：Git 使用规范流程 - 阮一峰的网络日志">
<meta name="application-name" content="夜航星">
<meta name="apple-mobile-web-app-title" content="夜航星">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://austinxt.github.io/2019-03-26-git/" /><link rel="prev" href="https://austinxt.github.io/2019-04-06-deploy-django/" /><link rel="next" href="https://austinxt.github.io/2019-07-15-cancer-history/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Git 使用指南",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/austinxt.github.io\/2019-03-26-git\/"
        },"genre": "posts","keywords": "Git","wordcount":  8198 ,
        "url": "https:\/\/austinxt.github.io\/2019-03-26-git\/","datePublished": "2019-04-06T00:00:00+08:00","dateModified": "2019-04-06T00:00:00+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "夜航星"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="夜航星">夜航星</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/talks/"> 呓语 </a><a class="menu-item" href="/posts/" title="文章"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="夜航星">夜航星</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/talks/" title="">呓语</a><a class="menu-item" href="/posts/" title="文章">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Git 使用指南</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://blog.nightvoyager.top/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>夜航星</a></span>&nbsp;<span class="post-category">included in <a href="/categories/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>知识整理</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2019-04-06">2019-04-06</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;8198 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;17 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#git-快速上手">Git 快速上手</a>
      <ul>
        <li><a href="#git-基本概念">Git 基本概念</a></li>
        <li><a href="#安装-git">安装 Git</a>
          <ul>
            <li><a href="#linux">Linux</a></li>
            <li><a href="#macos">macOS</a></li>
          </ul>
        </li>
        <li><a href="#全局配置">全局配置</a></li>
        <li><a href="#创建版本库-repository仓库-和提交修改">创建版本库 (repository，仓库) 和提交修改</a>
          <ul>
            <li><a href="#创建版本库">创建版本库</a></li>
            <li><a href="#把工作区目录的修改添加到暂存区">把工作区（目录）的修改添加到暂存区</a></li>
            <li><a href="#查看仓库当前状态">查看仓库当前状态</a></li>
            <li><a href="#提交到当前分支">提交到当前分支</a></li>
            <li><a href="#一步将工作区的修改提交到分支">一步将工作区的修改提交到分支</a></li>
          </ul>
        </li>
        <li><a href="#撤销修改和版本回滚">撤销修改和版本回滚</a>
          <ul>
            <li><a href="#查看工作区的修改">查看工作区的修改</a></li>
            <li><a href="#撤销工作区修改">撤销工作区修改</a></li>
            <li><a href="#撤销添加到暂存区">撤销添加到暂存区</a></li>
            <li><a href="#版本回退">版本回退</a></li>
            <li><a href="#删除文件">删除文件</a></li>
          </ul>
        </li>
        <li><a href="#远程仓库">远程仓库</a>
          <ul>
            <li><a href="#建立本地-ssh-key-密钥对">建立本地 SSH Key 密钥对</a></li>
            <li><a href="#把公钥给-github">把公钥给 GitHub</a></li>
            <li><a href="#关联远程仓库">关联远程仓库</a></li>
            <li><a href="#从远程库克隆">从远程库克隆</a></li>
            <li><a href="#ssh-警告">SSH 警告</a></li>
            <li><a href="#忽略特殊文件">忽略特殊文件</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#分支管理">分支管理</a>
      <ul>
        <li><a href="#创建与合并分支">创建与合并分支</a>
          <ul>
            <li><a href="#创建分支">创建分支</a></li>
            <li><a href="#合并分支">合并分支</a></li>
            <li><a href="#解决分支合并冲突">解决分支合并冲突</a></li>
          </ul>
        </li>
        <li><a href="#分支管理策略">分支管理策略</a>
          <ul>
            <li><a href="#bug-分支">Bug 分支</a></li>
            <li><a href="#feature-分支">Feature 分支</a></li>
            <li><a href="#git-工作流程">Git 工作流程</a></li>
          </ul>
        </li>
        <li><a href="#多人协作开发">多人协作开发</a>
          <ul>
            <li><a href="#推送分支">推送分支</a></li>
            <li><a href="#抓取分支">抓取分支</a></li>
            <li><a href="#rebase">Rebase</a></li>
          </ul>
        </li>
        <li><a href="#git-远程操作">Git 远程操作</a>
          <ul>
            <li><a href="#git-remote">git remote</a></li>
            <li><a href="#git-fetch">git fetch</a></li>
            <li><a href="#git-pull">git pull</a></li>
            <li><a href="#git-push">git push</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#标签管理">标签管理</a>
      <ul>
        <li><a href="#创建标签">创建标签</a></li>
        <li><a href="#操作标签">操作标签</a></li>
      </ul>
    </li>
    <li><a href="#其他-git-技巧">其他 Git 技巧</a>
      <ul>
        <li><a href="#配置别名">配置别名</a></li>
        <li><a href="#搭建-git-服务器">搭建 Git 服务器</a></li>
      </ul>
    </li>
    <li><a href="#ref">Ref</a></li>
    <li><a href="#changelog">ChangeLog</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><blockquote>
<p>Git 是目前世界上最先进的分布式文本文件版本控制系统</p></blockquote>
<h2 id="git-快速上手">Git 快速上手</h2>
<p>Cheat Sheet：<a href="http://ndpsoftware.com/git-cheatsheet.html#loc=workspace;" target="_blank" rel="noopener noreffer ">workspace :: Git Cheatsheet</a> 、<a href="http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html" target="_blank" rel="noopener noreffer ">常用 Git 命令清单 - 阮一峰的网络日志</a></p>
<p>Git 使用流程：<a href="http://www.ruanyifeng.com/blog/2015/08/git-use-process.html" target="_blank" rel="noopener noreffer ">Git 使用规范流程 - 阮一峰的网络日志</a></p>
<h3 id="git-基本概念">Git 基本概念</h3>
<ul>
<li>工作区（Working Directory），即电脑里能看到的目录</li>
<li>版本库/本地仓库（Repository），即工作区的隐藏目录 <code>.git</code> ，包含暂存区、分支、HEAD 等</li>
<li>暂存区（stage/index），存在于版本库之中</li>
<li>分支（branch），Git 创建版本库时，会自动创建第一个分支 <code>master</code> ，以及指向 <code>master</code> 的一个指针 <code>HEAD</code></li>
<li>远程仓库（remote repository）</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="http://gityuan.com/images/git/1.png"
        data-srcset="http://gityuan.com/images/git/1.png, http://gityuan.com/images/git/1.png 1.5x, http://gityuan.com/images/git/1.png 2x"
        data-sizes="auto"
        alt="http://gityuan.com/images/git/1.png"
        title="http://gityuan.com/images/git/1.png" /></p>
<p>上图来自：<a href="http://gityuan.com/2015/06/27/git-notes/" target="_blank" rel="noopener noreffer ">Git 常用命令 - Gityuan 博客 | 袁辉辉的 Android 博客</a></p>
<h3 id="安装-git">安装 Git</h3>
<h4 id="linux">Linux</h4>
<p>可以用 <code>git</code> 在终端测试系统是否安装了 Git，安装方法是 <code>sudo apt-get install git</code></p>
<h4 id="macos">macOS</h4>
<p>一是安装 homebrew，然后通过 homebrew 安装 Git，具体方法请参考 homebrew 的文档：<a href="https://brew.sh/" target="_blank" rel="noopener noreffer ">The missing package manager for macOS (or Linux)</a>。</p>
<p>二是直接从 AppStore 安装 Xcode，更简单，也更推荐。Xcode 集成了 Git，不过默认没有安装，你需要运行 Xcode，选择菜单 <code>Xcode-&gt;Preferences</code> ，在弹出窗口中找到 <code>Downloads</code> ，选择 <code>Command Line Tools</code>，点 <code>Install</code>就可以完成安装了。</p>
<h3 id="全局配置">全局配置</h3>
<p>安装完成后，还需要最后一步设置，在命令行输入：</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git config --global user.name <span class="s2">&#34;Your Name&#34;</span>
</span></span><span class="line"><span class="cl">$ git config --global user.email <span class="s2">&#34;email@example.com&#34;</span></span></span></code></pre></div></div>
<p>因为 Git 是分布式版本控制系统，所以要表明各自的身份。</p>
<h3 id="创建版本库-repository仓库-和提交修改">创建版本库 (repository，仓库) 和提交修改</h3>
<p>版本库可以简单理解成一个目录，这个目录里面的所有文件都可以被 Git 管理起来，每个文件的修改、删除，Git 都能跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻可以还原。</p>
<h4 id="创建版本库">创建版本库</h4>
<p>进入到一个目录，通过 <code>git init</code> 命令把这个目录变成 Git 可以管理的仓库，此时输入 <code>ls -ah</code> 命令，发现当前目录下多了一个 <code>.git</code> 的目录</p>
<h4 id="把工作区目录的修改添加到暂存区">把工作区（目录）的修改添加到暂存区</h4>
<p>若新建了 <code>README.md</code> ，用命令 <code>git add README.md</code> 把文件添加到仓库暂存区，<code>git add .</code> 可将所有的修改添加到暂存区</p>
<h4 id="查看仓库当前状态">查看仓库当前状态</h4>
<p>用命令 <code>git status</code> 可以查看仓库当前状态</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">On branch master
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">No commits yet
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Changes to be committed:
</span></span><span class="line"><span class="cl">  (use &#34;git rm --cached &lt;file&gt;...&#34; to unstage)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	new file:   README.md</span></span></code></pre></div></div>
<h4 id="提交到当前分支">提交到当前分支</h4>
<p>用命令 <code>git commit -m &quot;commit message&quot;</code> 把本次修改提交到当前分支，此时工作区变为 <code>nothing to commit, working tree clean</code></p>
<h4 id="一步将工作区的修改提交到分支">一步将工作区的修改提交到分支</h4>
<p>用命令 <code>git commit -am &quot;commit message&quot;</code> 可以提交工作区所有 tracked 的修改到当前分支。</p>
<h3 id="撤销修改和版本回滚">撤销修改和版本回滚</h3>
<p>万事都有失，Git 挽回失误的操作有撤销「添加到暂存区」、撤销「本次提交到当前分支」、回滚到「之前的某一次提交」。</p>
<h4 id="查看工作区的修改">查看工作区的修改</h4>
<p><code>git diff</code> 查看上次对工作区的修改，显示工作区与暂存区的比较（优先）或工作区与当前分支比较，显示的格式正是 Unix 通用的 diff 格式。</p>
<h4 id="撤销工作区修改">撤销工作区修改</h4>
<p>用 <code>git status</code> 查看当前仓库状态时，<code>Changes not staged for commit:</code> 下面会提示如何撤销工作区修改， <code>use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory</code> ，即用 <code>git checkout -- &lt;file&gt;</code> 将文件在工作区的修改恢复到上一次添加到暂存区后的状态（优先）或当前分支的状态。</p>
<h4 id="撤销添加到暂存区">撤销添加到暂存区</h4>
<p>用 <code>git status</code> 查看当前仓库状态时，<code>Changes to be committed:</code> 下面会提示如何撤销暂存区的修改， <code>use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage</code> ，即用 <code>git reset HEAD &lt;file&gt;</code> 把暂存区的修改撤销掉，重新放回工作区。若再用 <code>git checkout -- &lt;file&gt;</code> 可以把文件恢复与版本库中当前版本一致。</p>
<h4 id="版本回退">版本回退</h4>
<p>用 <code>git log</code> 命令查看提交日志（从最近到最远），加上 <code>--pretty=oneline</code> 参数，仅显示版本号（commit id）、commit message 和 HEAD 指针的指向当前版本。</p>
<p>使用 <code>git reset</code> 命令可退回以前版本，原理是改变 HEAD 指针的指向，其间提交的版本不可在 <code>git log</code> 命令下显示。</p>
<ul>
<li>使用 <code>git reset --hard HEAD^</code> 命令退回到上一个版本</li>
<li>或用 <code>git reset --hard HEAD~n</code> 往前退回 n 版本</li>
<li>或用 <code>git reset -- hard &lt;前五位 commit id&gt;</code> 回退到一特定版本</li>
</ul>
<p>Git 提供了一个命令 <code>git reflog</code> 来记录每一次提交，包括 HEAD 指针之后的版本，用 <code>git reset -- hard &lt;前五位 commit id&gt;</code> 依旧可以回退到一特定版本。</p>
<h4 id="删除文件">删除文件</h4>
<p>从版本库中删除文件可用命令 <code>git rm &lt;file&gt;</code> ，参数 <code> —cached</code> 保存工作区的文件， <code> -f</code> 删除工作区和版本库的文件。</p>
<h3 id="远程仓库">远程仓库</h3>
<p>远程仓库以 GitHub 为例。</p>
<h4 id="建立本地-ssh-key-密钥对">建立本地 SSH Key 密钥对</h4>
<p>本地 Git 仓库和 GitHub 仓库之间的传输是通过 SSH 加密的，需要创建 SSH Key。</p>
<p>在用户主目录下，看看有没有 <code>.ssh/ </code> 目录，若有，再看看这个目录下有没有 <code>id_rsa</code> 和 <code>id_rsa.pub</code> 文件，若有，可直接跳过这一步。若没有，打开 Shell 创建 SSH Key，<code>ssh-keygen -t rsa -C &quot;youremail@example.com&quot;</code> ，为了方便无需设置密码。</p>
<p>一路回车后，在用户主目录里找到 <code>.ssh</code> 目录，里面有 <code>id_rsa</code> 和 <code>id_rsa.pub</code> 两个文件，即 SSH Key 的密钥对， <code>id_rsa</code> 是私钥，不能泄露出去， <code>id_rsa.pub</code> 是公钥。</p>
<h4 id="把公钥给-github">把公钥给 GitHub</h4>
<p>登陆 GitHub，打开 <code>Account settings</code> ，进入 <code>SSH Keys</code> 页面，点 <code>Add SSH Key</code> ，填上任意 Title，在 Key 文本框里粘贴 <code>id_rsa.pub</code> 文件的内容。</p>
<h4 id="关联远程仓库">关联远程仓库</h4>
<p>在 GitHub 新建一个空仓库，根据 GitHub 提示，在本地仓库下运行 <code>git remote add origin git@github.com:&lt;GitHub Username&gt;/&lt;repository name&gt;.git</code> 命令。 <code>origin</code> 就是远程仓库的名字，是 Git 的默认叫法。</p>
<p>下一步把本地库的所有内容推送到远程库上，运行 <code>git push -u origin master</code> 可以把当前分支 <code>master</code> 推送到 <code>origin</code> 。参数 <code>-u</code> 会把本地的 <code>master</code> 分支与远程的 <code>master</code> 分支关联，以后推送或拉取时就可以简化为 <code>git push</code> 和 <code>git pull</code> 。</p>
<h4 id="从远程库克隆">从远程库克隆</h4>
<p>运行 <code>git clone git@github.com:&lt;GitHub Username&gt;/&lt;repository name&gt;.git</code> 可以将远程仓库克隆到本地，会在当前目录下生成一个 <code>repository name</code> 文件。</p>
<p>Git 支持多种协议，包括 <code>https </code>，但通过 <code>ssh</code> 支持的原生 <code>git</code> 协议速度最快。</p>
<h4 id="ssh-警告">SSH 警告</h4>
<p>第一次使用 Git 的 <code>clone</code> 或者 <code>push</code> 命令连接 GitHub 时，会得到一个警告：</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">The authenticity of host &#39;github.com (xx.xx.xx.xx)&#39; can&#39;t be established.
</span></span><span class="line"><span class="cl">RSA key fingerprint is xx.xx.xx.xx.xx.
</span></span><span class="line"><span class="cl">Are you sure you want to continue connecting (yes/no)?</span></span></code></pre></div></div>
<p>这是因为 Git 使用 SSH 连接，而 SSH 连接在第一次验证 GitHub 服务器的 Key 时，需要你确认 GitHub 的 Key 的指纹信息是否真的来自 GitHub 的服务器，输入<code>yes</code> 回车即可。此时 <code>~/.ssh/konwn_host</code> 文件里会多一个 github.com host.</p>
<h4 id="忽略特殊文件">忽略特殊文件</h4>
<p>在 Git 工作区的根目录下创建一个特殊的 <code>.gitignore</code> 文件，然后把要忽略的文件名填进去，Git 就会自动忽略这些文件。GitHub 已经为我们准备了各种配置文件：<a href="https://github.com/github/gitignore" target="_blank" rel="noopener noreffer ">github/gitignore: A collection of useful .gitignore templates</a> ，再把 <code>.gitignore</code> 也提交到 Git。</p>
<p>忽略文件的原则是：</p>
<ol>
<li>忽略操作系统自动生成的文件，比如缩略图等；</li>
<li>忽略编译生成的中间文件、可执行文件等，也就是若一个文件是通过另一个文件自动生成的，那自动生成的文件就没必要放进版本库，比如 Python 编译产生的 <code>.pyc</code> 文件、 <code>.pyo</code> 文件和 <code>dist</code> 目录；</li>
<li>忽略你自己的带有敏感信息的配置文件，比如存放口令的配置文件。</li>
</ol>
<p>若确实想添加被忽略的文件，可以用 <code>-f</code> 强制添加到 Git，<code>git add -f test.pyc</code> 。</p>
<p><code>git check-ignore </code>命令检查被忽略的文件来自哪条规则</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git check-ignore -v test.pyc
</span></span><span class="line"><span class="cl">.gitignore:2:__pycache__/    test.pyc</span></span></code></pre></div></div>
<p><code>.gitignore </code>的第 2 行规则忽略了该文件。</p>
<h2 id="分支管理">分支管理</h2>
<p>分支管理可以让开发者从容地写一个新功能，而不用担心代码无处提交。</p>
<h3 id="创建与合并分支">创建与合并分支</h3>
<p>截止到目前，在 Git 里只有一个分支，叫主分支，即<code>master</code>分支。<code>master</code> 指向提交，<code>HEAD </code>指向当前分支，每次提交，<code>master </code>分支都会向前移动一步。</p>
<h4 id="创建分支">创建分支</h4>
<p>运行 <code>git checkout -b dev</code> 创建新的分支，并切换到 <code>dev</code> 分支。 <code>git checkout</code> 加上 <code>-b</code>参数表示创建并切换，相当于创建新的分支 <code>git branch dev</code> 加上切换分支 <code>git checkout dev</code> .</p>
<p>创建新的分支时，例如 <code>dev</code> ，Git 会新建了一个指针叫 <code>dev</code> ，指向 <code>master</code> 相同的提交，再把 <code>HEAD</code> 指向 <code>dev</code> ，就表示当前分支在 <code>dev</code> 上。现在开始，对工作区的修改和提交就是针对 <code>dev</code> 分支，比如新提交一次后，<code>dev </code>指针往前移动一步，而 <code>master</code> 指针不变。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">          master
</span></span><span class="line"><span class="cl">            ↓
</span></span><span class="line"><span class="cl">○---○---○---○---○
</span></span><span class="line"><span class="cl">                ↑
</span></span><span class="line"><span class="cl">               dev ← HEAD</span></span></code></pre></div></div>
<h4 id="合并分支">合并分支</h4>
<p>假如在 <code>dev</code> 上的工作完成了，就可以把 <code>dev</code> 合并到 <code>master</code> 上，最简单的方法，就是直接把 <code>master</code> 指向 <code>dev</code> 的当前提交。</p>
<p>命令是运行 <code>git checkout master</code> 把 HEAD 指针指向 <code>master</code> 分支，然后运行 <code>git merge dev</code> 把 <code>dev</code> 分支的工作成果合并到 <code>master</code> 分支上。终端返回 <code>Fast-forward</code> 信息表示这次合并是「快进模式」，即直接把 <code>master</code> 指向 <code>dev</code> 的当前提交。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">             master ← HEAD
</span></span><span class="line"><span class="cl">                ↓
</span></span><span class="line"><span class="cl">○---○---○---○---○
</span></span><span class="line"><span class="cl">                ↑
</span></span><span class="line"><span class="cl">               dev</span></span></code></pre></div></div>
<p>但不是每次合并都能 <code>Fast-forward</code> ，后面会讲其他方式的合并。</p>
<p>合并完分支后，可以删除 <code>dev</code> 分支， <code>git branch -d dev</code> ，即删除<code>dev</code> 指针。删除后，查看 <code>branch</code> ， <code>git branch</code> ，只剩下 <code>master</code> 分支。</p>
<h4 id="解决分支合并冲突">解决分支合并冲突</h4>
<p>若在新建的分支 <code>dev</code> 修改了 <code>README.md</code> 并提交，又切换回 <code>master</code> 分支，修改了 <code>README.md</code> 并提交，则此时的 <code>master</code> 和 <code>dev</code> 处在不同的提交时间轴上。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">             master ← HEAD
</span></span><span class="line"><span class="cl">                ↓
</span></span><span class="line"><span class="cl">○---○---○---○---○
</span></span><span class="line"><span class="cl">             \---○
</span></span><span class="line"><span class="cl">                 ↑
</span></span><span class="line"><span class="cl">                dev</span></span></code></pre></div></div>
<p>此时运行 <code>git merge dev</code> ，会报错（ <code>git status</code> 也会提示冲突的文件）</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Auto-merging README.md
</span></span><span class="line"><span class="cl">CONFLICT (content): Merge conflict in README.md
</span></span><span class="line"><span class="cl">Automatic merge failed; fix conflicts and then commit the result.</span></span></code></pre></div></div>
<p><code>README.md</code> 文件存在冲突，必须手动解决冲突后再提交。查看 <code>README.md</code></p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">&lt;&lt;&lt;&lt;&lt;&lt;</span>&lt; HEAD
</span></span><span class="line"><span class="cl">Creating a new branch is quick <span class="p">&amp;</span> simple.
</span></span><span class="line"><span class="cl"><span class="o">=======</span>
</span></span><span class="line"><span class="cl">Creating a new branch is quick AND simple.
</span></span><span class="line"><span class="cl">&gt;&gt;&gt;&gt;&gt;&gt;&gt; dev</span></span></code></pre></div></div>
<p>Git 用 <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> ， <code>======= </code>， <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code> 标记出不同分支的内容，假如修改 <code>README.md</code> 为</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Creating a new branch is quick and simple.</span></span></code></pre></div></div>
<p>再提交</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git add README.md
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;conflict fixed&#34;</span></span></span></code></pre></div></div>
<p>现在 <code>master</code> 分支和 <code>dev</code> 成了下图所示</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">                 master ← HEAD
</span></span><span class="line"><span class="cl">										↓
</span></span><span class="line"><span class="cl">○---○---○---○---○---○
</span></span><span class="line"><span class="cl">             \--○--/
</span></span><span class="line"><span class="cl">                ↑
</span></span><span class="line"><span class="cl">               dev</span></span></code></pre></div></div>
<p><code>git log --graph --pretty=oneline --abbrev-commit</code> 可以看到分支的合并情况。 <code> —graph</code> 参数可查看分支合并图，<code>--abbrev-commit</code> 参数可缩写 commit 信息。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">*   b75b466 (HEAD -&gt; master) conflict fixed
</span></span><span class="line"><span class="cl">|\
</span></span><span class="line"><span class="cl">| * 3d0eb40 (feature1) using And
</span></span><span class="line"><span class="cl">* | 42c89d0 using &amp;
</span></span><span class="line"><span class="cl">|/
</span></span><span class="line"><span class="cl">* 01c11b4 branch test
</span></span><span class="line"><span class="cl">...</span></span></code></pre></div></div>
<p>删除 <code>dev</code> 分支。</p>
<h3 id="分支管理策略">分支管理策略</h3>
<p>通常，合并分支时，若可能，Git 会用 <code>Fast forward</code> 模式，但这种模式下，删除分支后会丢掉分支信息。</p>
<p>若要强制禁用 <code>Fast forward </code>模式，Git 就会在 merge 时生成一个新的 commit，这样，从分支历史上就可以看出分支信息。可以在 merge 时添加 <code>--no-ff</code> 参数在分支历史上呈现合并分支信息，<code>--no-ff</code> 参数表示禁用 <code>Fast forward</code> 。</p>
<p>仍然创建并切换 <code>dev</code> 分支，修改 <code>README.md</code> 文件，并提交一个新的 commit，再切换回 <code>master</code> 。此时运行 <code>git merge --no-ff -m &quot;merge with no-ff&quot; dev</code> ，终端返回</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Merge made by the &#39;recursive&#39; strategy.
</span></span><span class="line"><span class="cl"> README.md | 1 +
</span></span><span class="line"><span class="cl"> 1 file changed, 1 insertion(+)</span></span></code></pre></div></div>
<p>合并后，用 <code>git log</code> 查看分支历史</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git log --graph --pretty<span class="o">=</span>oneline --abbrev-commit
</span></span><span class="line"><span class="cl">*   3481f74 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> merge with no-ff
</span></span><span class="line"><span class="cl"><span class="p">|</span><span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> * 3a86b6c <span class="o">(</span>dev<span class="o">)</span> add merge
</span></span><span class="line"><span class="cl"><span class="p">|</span>/
</span></span><span class="line"><span class="cl">*   b75b466 conflict fixed
</span></span><span class="line"><span class="cl">...</span></span></code></pre></div></div>
<p>在实际开发中，应该按照几个基本原则进行分支管理：</p>
<ol>
<li><code>master </code>分支应该非常稳定，仅用来发布新版本，平时不能在上面干活；</li>
<li>干活都在 <code>dev</code> 分支上，版本发布时，再把 <code>dev</code> 分支合并到 <code>master</code> 上，在 <code>master</code> 分支发布版本；</li>
<li>团队合作时，每个人都在 <code>dev</code> 分支上干活，每个人都有自己的分支，时不时地往 <code>dev</code> 分支上合并。</li>
</ol>
<h4 id="bug-分支">Bug 分支</h4>
<p>每个 bug 都可以通过一个新的临时分支来修复，修复后合并分支，然后将临时分支删除。</p>
<p>Git 提供了一个 <code>stash</code> 功能，可以把当前工作现场「储藏」起来，等以后恢复现场后继续工作。</p>
<p>在 <code>dev</code> 分支修改 <code>README.md</code> 后，</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git stash
</span></span><span class="line"><span class="cl">Saved working directory and index state WIP on dev: 3a86b6c <span class="nb">test</span> hard merge</span></span></code></pre></div></div>
<p>现在用 <code>git status</code> 查看工作区，是干净的，因此可以放心地创建分支来修复 bug。</p>
<p>若需要在 <code>master </code>分支上修复 bug，则从 <code>master</code> 创建临时分支。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git checkout master
</span></span><span class="line"><span class="cl">$ git checkout -b issue-101</span></span></code></pre></div></div>
<p>修改 bug，这里修改了 <code>README.md</code> ，然后提交</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git commit -am <span class="s2">&#34;fix bug 101&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>issue-101 4d97816<span class="o">]</span> fix bug <span class="m">101</span>
</span></span><span class="line"><span class="cl"> <span class="m">1</span> file changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span>, <span class="m">1</span> deletion<span class="o">(</span>-<span class="o">)</span></span></span></code></pre></div></div>
<p>修复完成后，切换到 <code>master</code> 分支，并完成合并，最后删除 <code>issue-101</code> 分支</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git checkout master
</span></span><span class="line"><span class="cl">$ git merge --no-ff -m <span class="s2">&#34;merged bug fix 101&#34;</span> issue-101
</span></span><span class="line"><span class="cl">Merge made by the <span class="s1">&#39;recursive&#39;</span> strategy.
</span></span><span class="line"><span class="cl"> readme.txt <span class="p">|</span> <span class="m">2</span> +-
</span></span><span class="line"><span class="cl"> <span class="m">1</span> file changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span>, <span class="m">1</span> deletion<span class="o">(</span>-<span class="o">)</span>
</span></span><span class="line"><span class="cl">$ git branch -d issue-101</span></span></code></pre></div></div>
<p>重新回到 <code>dev</code> 分支干活</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git checkout dev
</span></span><span class="line"><span class="cl">$ git status
</span></span><span class="line"><span class="cl">On branch dev
</span></span><span class="line"><span class="cl">nothing to commit, working tree clean</span></span></code></pre></div></div>
<p>工作区是干净的，用 <code>git stash list</code> 命令工作现场</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git stash list
</span></span><span class="line"><span class="cl">stash@<span class="o">{</span>0<span class="o">}</span>: WIP on dev: 3a86b6c add merge</span></span></code></pre></div></div>
<p>恢复工作现场有两个办法</p>
<ul>
<li>用 <code>git stash apply</code> 恢复，但是恢复后，stash 内容并不删除，需要用 <code>git stash drop</code> 来删除</li>
<li>用 <code>git stash pop</code> ，恢复的同时把 stash 内容也删了</li>
</ul>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git stash pop
</span></span><span class="line"><span class="cl">On branch dev
</span></span><span class="line"><span class="cl">Changes not staged <span class="k">for</span> commit:
</span></span><span class="line"><span class="cl">  <span class="o">(</span>use <span class="s2">&#34;git add &lt;file&gt;...&#34;</span> to update what will be committed<span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">(</span>use <span class="s2">&#34;git checkout -- &lt;file&gt;...&#34;</span> to discard changes in working directory<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	modified:   README.md
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">no changes added to commit <span class="o">(</span>use <span class="s2">&#34;git add&#34;</span> and/or <span class="s2">&#34;git commit -a&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">Dropped refs/stash@<span class="o">{</span>0<span class="o">}</span> <span class="o">(</span>e8f4328c3334144570f3c6d38641fc971aa460a2<span class="o">)</span></span></span></code></pre></div></div>
<p>此外，还可以多次 stash，恢复的时候，先用 <code>git stash list</code> 查看，然后恢复指定的 stash，用命令 <code>git stash apply stash@{0}</code> 。</p>
<h4 id="feature-分支">Feature 分支</h4>
<p>软件开发中，总有无穷无尽的新的功能要不断添加进来。每添加一个新功能，最好在新建分支 <code>feature</code> 上面开发（以免污染 <code>dev</code> ），完成后合并删除 <code>feature</code> 分支。</p>
<p>若新功能突然不需要了，<code>git branch -d feature-name</code> 命令会报错</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">error: The branch &#39;feature-name&#39; is not fully merged.
</span></span><span class="line"><span class="cl">If you are sure you want to delete it, run &#39;git branch -D feature-name&#39;.</span></span></code></pre></div></div>
<p>可以运行 <code>git branch -D feature-name</code> 强行删除。</p>
<h4 id="git-工作流程">Git 工作流程</h4>
<p><a href="http://www.ruanyifeng.com/blog/2015/12/git-workflow.html" target="_blank" rel="noopener noreffer ">Git 工作流程 - 阮一峰的网络日志</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2012/07/git.html" target="_blank" rel="noopener noreffer ">Git 分支管理策略 - 阮一峰的网络日志</a></p>
<h3 id="多人协作开发">多人协作开发</h3>
<p>要查看远程库的信息，用 <code>git remote</code> ，或者用 <code>git remote -v</code> 显示更详细的信息</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git remote -v
</span></span><span class="line"><span class="cl">origin  git@github.com:michaelliao/learngit.git <span class="o">(</span>fetch<span class="o">)</span>
</span></span><span class="line"><span class="cl">origin  git@github.com:michaelliao/learngit.git <span class="o">(</span>push<span class="o">)</span></span></span></code></pre></div></div>
<p>上面显示了可以抓取和推送的 <code>origin</code> 的地址，若没有推送权限，就看不到 push 的地址。</p>
<h4 id="推送分支">推送分支</h4>
<p>推送分支，就是把该分支上的所有本地提交推送到远程库。推送时，要指定本地分支，这样 Git 就会把该分支推送到远程库对应的远程分支上，例如 <code>git push origin dev</code> 。</p>
<p>有些本地分支不需要往远程推送，有些本地分支需要往远程推送</p>
<ul>
<li><code>master </code> 分支是主分支，要时刻与远程同步；</li>
<li><code>dev</code> 分支是开发分支，团队所有成员都需要在上面工作，所以也需要与远程同步；</li>
<li>bug 分支只用于在本地修复 bug，就没必要推到远程了；</li>
<li>feature 分支是否推到远程，取决于是否和小伙伴合作在上面开发。</li>
</ul>
<h4 id="抓取分支">抓取分支</h4>
<p>多人协作时，大家都会往 <code>master</code> 和 <code>dev</code> 分支上推送各自的修改。</p>
<p>假设有小伙伴要在 <code>dev</code> 分支上开发，就必须创建远程 <code>origin</code> 的 <code>dev</code> 分支到本地，于是他用命令 <code>git checkout -b dev origin/dev</code> 创建本地 <code>dev</code> 分支。接着他修改了 <code>README.md</code> ，并提交到本地仓库的 <code>dev</code> 分支，然后 <code>git push origin dev</code> 推送到远程仓库。</p>
<p>碰巧你也修改了 <code>README.md</code> ，并提交到本地仓库的 <code>dev</code> 分支。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git push origin dev
</span></span><span class="line"><span class="cl">To github.com:&lt;github username&gt;/&lt;repository&gt;.git
</span></span><span class="line"><span class="cl"> ! <span class="o">[</span>rejected<span class="o">]</span>        dev -&gt; dev <span class="o">(</span>non-fast-forward<span class="o">)</span>
</span></span><span class="line"><span class="cl">error: failed to push some refs to <span class="s1">&#39;git@github.com:&lt;github username&gt;/&lt;repository&gt;.git&#39;</span>
</span></span><span class="line"><span class="cl">hint: Updates were rejected because the tip of your current branch is behind
</span></span><span class="line"><span class="cl">hint: its remote counterpart. Integrate the remote changes <span class="o">(</span>e.g.
</span></span><span class="line"><span class="cl">hint: <span class="s1">&#39;git pull ...&#39;</span><span class="o">)</span> before pushing again.
</span></span><span class="line"><span class="cl">hint: See the <span class="s1">&#39;Note about fast-forwards&#39;</span> in <span class="s1">&#39;git push --help&#39;</span> <span class="k">for</span> details.</span></span></code></pre></div></div>
<p>因为有小伙伴的最新提交和你试图推送的提交有冲突，所以推送失败。解决办法 Git 已经提示我们，先用 <code>git pull</code> 把最新的提交从 <code>origin/dev</code> 抓下来，然后在本地合并，解决冲突，再推送。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git pull
</span></span><span class="line"><span class="cl">There is no tracking information <span class="k">for</span> the current branch.
</span></span><span class="line"><span class="cl">Please specify which branch you want to merge with.
</span></span><span class="line"><span class="cl">See git-pull<span class="o">(</span>1<span class="o">)</span> <span class="k">for</span> details.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    git pull &lt;remote&gt; &lt;branch&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">If you wish to <span class="nb">set</span> tracking information <span class="k">for</span> this branch you can <span class="k">do</span> so with:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    git branch --set-upstream-to<span class="o">=</span>origin/&lt;branch&gt; dev</span></span></code></pre></div></div>
<p><code>git pull </code>也失败了，原因是没有指定本地 <code>dev</code> 分支与远程 <code>origin/dev</code> 分支的链接，根据提示设置 <code>dev</code> 和 <code>origin/dev</code> 的链接，再 pull</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git branch --set-upstream-to<span class="o">=</span>origin/dev dev
</span></span><span class="line"><span class="cl">Branch <span class="s1">&#39;dev&#39;</span> <span class="nb">set</span> up to track remote branch <span class="s1">&#39;dev&#39;</span> from <span class="s1">&#39;origin&#39;</span>.
</span></span><span class="line"><span class="cl">$ git pull
</span></span><span class="line"><span class="cl">Auto-merging README.md
</span></span><span class="line"><span class="cl">CONFLICT <span class="o">(</span>add/add<span class="o">)</span>: Merge conflict in README.md
</span></span><span class="line"><span class="cl">Automatic merge failed<span class="p">;</span> fix conflicts and <span class="k">then</span> commit the result.</span></span></code></pre></div></div>
<p><code>git pull </code> 成功，但是合并有冲突，需要手动解决，见前文「解决分支合并冲突」，再 <code>git push origin dev</code> 。</p>
<h4 id="rebase">Rebase</h4>
<p>多人在同一个分支上协作时，很容易出现冲突。即使没有冲突，后 push 的小伙伴也不得不先 pull，在本地合并，然后才能 push 成功。</p>
<p>每次合并再 push 后，分支变成了这样</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git log --graph --pretty<span class="o">=</span>oneline --abbrev-commit
</span></span><span class="line"><span class="cl">* d1be385 <span class="o">(</span>HEAD -&gt; master, origin/master<span class="o">)</span> init hello
</span></span><span class="line"><span class="cl">*   e5e69f1 Merge branch <span class="s1">&#39;dev&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span><span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> *   57c53ab <span class="o">(</span>origin/dev, dev<span class="o">)</span> fix env conflict
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="p">|</span><span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> <span class="p">|</span> * 7a5e5dd add env
</span></span><span class="line"><span class="cl"><span class="p">|</span> * <span class="p">|</span> 7bd91f1 add new env
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="p">|</span>/
</span></span><span class="line"><span class="cl">* <span class="p">|</span>   12a631b merged bug fix <span class="m">101</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span><span class="se">\ \
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> * <span class="p">|</span> 4c805e2 fix bug <span class="m">101</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>/ /
</span></span><span class="line"><span class="cl">* <span class="p">|</span>   e1e9c68 merge with no-ff
</span></span><span class="line"><span class="cl"><span class="p">|</span><span class="se">\ \
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> <span class="p">|</span>/
</span></span><span class="line"><span class="cl"><span class="p">|</span> * f52c633 add merge
</span></span><span class="line"><span class="cl"><span class="p">|</span>/
</span></span><span class="line"><span class="cl">*   cf810e4 conflict fixed
</span></span><span class="line"><span class="cl">...</span></span></code></pre></div></div>
<p>Git 有一种称为 rebase(变基) 的操作，能把分叉的提交变成直线，使查看历史提交的变化更容易。</p>
<p>在和远程分支同步后，对 <code>hello.py</code> 做了两次提交。用 <code>git log</code> 命令查看</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git log --graph --pretty<span class="o">=</span>oneline --abbrev-commit
</span></span><span class="line"><span class="cl">* 582d922 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> add author
</span></span><span class="line"><span class="cl">* <span class="m">8875536</span> add comment
</span></span><span class="line"><span class="cl">* d1be385 <span class="o">(</span>origin/master<span class="o">)</span> init hello
</span></span><span class="line"><span class="cl">*   e5e69f1 Merge branch <span class="s1">&#39;dev&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span><span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> *   57c53ab <span class="o">(</span>origin/dev, dev<span class="o">)</span> fix env conflict
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="p">|</span><span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> <span class="p">|</span> * 7a5e5dd add env
</span></span><span class="line"><span class="cl"><span class="p">|</span> * <span class="p">|</span> 7bd91f1 add new env
</span></span><span class="line"><span class="cl">...</span></span></code></pre></div></div>
<p>注意到 Git 用 <code>(HEAD -&gt; master)</code> 和 <code>(origin/master)</code> 标识出当前分支的 HEAD 和远程 origin 的位置分别是 <code>582d922 add author</code> 和 <code>d1be385 init hello</code> ，本地分支比远程分支快两个提交。</p>
<p>现在尝试推送本地分支</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git push origin master
</span></span><span class="line"><span class="cl">To github.com:&lt;github username&gt;/&lt;repository&gt;.git
</span></span><span class="line"><span class="cl"> ! <span class="o">[</span>rejected<span class="o">]</span>        master -&gt; master <span class="o">(</span>fetch first<span class="o">)</span>
</span></span><span class="line"><span class="cl">error: failed to push some refs to <span class="s1">&#39;git@github.com:&lt;github username&gt;/&lt;repository&gt;.git&#39;</span>
</span></span><span class="line"><span class="cl">hint: Updates were rejected because the remote contains work that you <span class="k">do</span>
</span></span><span class="line"><span class="cl">hint: not have locally. This is usually caused by another repository pushing
</span></span><span class="line"><span class="cl">hint: to the same ref. You may want to first integrate the remote changes
</span></span><span class="line"><span class="cl">hint: <span class="o">(</span>e.g., <span class="s1">&#39;git pull ...&#39;</span><span class="o">)</span> before pushing again.
</span></span><span class="line"><span class="cl">hint: See the <span class="s1">&#39;Note about fast-forwards&#39;</span> in <span class="s1">&#39;git push --help&#39;</span> <span class="k">for</span> details.</span></span></code></pre></div></div>
<p>说明有小伙伴抢先推送了远程分支，按照提示先 pull</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git pull
</span></span><span class="line"><span class="cl">remote: Counting objects: 3, <span class="k">done</span>.
</span></span><span class="line"><span class="cl">remote: Compressing objects: 100% <span class="o">(</span>1/1<span class="o">)</span>, <span class="k">done</span>.
</span></span><span class="line"><span class="cl">remote: Total <span class="m">3</span> <span class="o">(</span>delta 1<span class="o">)</span>, reused <span class="m">3</span> <span class="o">(</span>delta 1<span class="o">)</span>, pack-reused <span class="m">0</span>
</span></span><span class="line"><span class="cl">Unpacking objects: 100% <span class="o">(</span>3/3<span class="o">)</span>, <span class="k">done</span>.
</span></span><span class="line"><span class="cl">From github.com:&lt;github username&gt;/&lt;repository&gt;
</span></span><span class="line"><span class="cl">   d1be385..f005ed4  master     -&gt; origin/master
</span></span><span class="line"><span class="cl"> * <span class="o">[</span>new tag<span class="o">]</span>         v1.0       -&gt; v1.0
</span></span><span class="line"><span class="cl">Auto-merging hello.py
</span></span><span class="line"><span class="cl">Merge made by the <span class="s1">&#39;recursive&#39;</span> strategy.
</span></span><span class="line"><span class="cl"> hello.py <span class="p">|</span> <span class="m">1</span> +
</span></span><span class="line"><span class="cl"> <span class="m">1</span> file changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span></span></span></code></pre></div></div>
<p>再用 <code>git status</code> 查看状态</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git status
</span></span><span class="line"><span class="cl">On branch master
</span></span><span class="line"><span class="cl">Your branch is ahead of <span class="s1">&#39;origin/master&#39;</span> by <span class="m">3</span> commits.
</span></span><span class="line"><span class="cl">  <span class="o">(</span>use <span class="s2">&#34;git push&#34;</span> to publish your <span class="nb">local</span> commits<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nothing to commit, working tree clean</span></span></code></pre></div></div>
<p>加上刚才合并的提交，现在本地分支比远程分支超前 3 个提交，用 <code>git log</code> 查看</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git log --graph --pretty<span class="o">=</span>oneline --abbrev-commit
</span></span><span class="line"><span class="cl">*   e0ea545 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> Merge branch <span class="s1">&#39;master&#39;</span> of github.com:&lt;github username&gt;/&lt;repository&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span><span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> * f005ed4 <span class="o">(</span>origin/master<span class="o">)</span> <span class="nb">set</span> <span class="nv">exit</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">* <span class="p">|</span> 582d922 add author
</span></span><span class="line"><span class="cl">* <span class="p">|</span> <span class="m">8875536</span> add comment
</span></span><span class="line"><span class="cl"><span class="p">|</span>/
</span></span><span class="line"><span class="cl">* d1be385 init hello
</span></span><span class="line"><span class="cl">...</span></span></code></pre></div></div>
<p>不好看！此时，rebase 派上了用场，把本地前几次推送的版本，从前往后与小伙伴已经推送的版本合并</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git rebase
</span></span><span class="line"><span class="cl">First, rewinding head to replay your work on top of it...
</span></span><span class="line"><span class="cl">Applying: add comment
</span></span><span class="line"><span class="cl">Using index info to reconstruct a base tree...
</span></span><span class="line"><span class="cl">M    hello.py
</span></span><span class="line"><span class="cl">Falling back to patching base and 3-way merge...
</span></span><span class="line"><span class="cl">Auto-merging hello.py
</span></span><span class="line"><span class="cl">Applying: add author
</span></span><span class="line"><span class="cl">Using index info to reconstruct a base tree...
</span></span><span class="line"><span class="cl">M    hello.py
</span></span><span class="line"><span class="cl">Falling back to patching base and 3-way merge...
</span></span><span class="line"><span class="cl">Auto-merging hello.py</span></span></code></pre></div></div>
<p>再用 <code>git log</code> 看看</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git log --graph --pretty<span class="o">=</span>oneline --abbrev-commit
</span></span><span class="line"><span class="cl">* 7e61ed4 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> add author
</span></span><span class="line"><span class="cl">* 3611cfe add comment
</span></span><span class="line"><span class="cl">* f005ed4 <span class="o">(</span>origin/master<span class="o">)</span> <span class="nb">set</span> <span class="nv">exit</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">* d1be385 init hello
</span></span><span class="line"><span class="cl">...</span></span></code></pre></div></div>
<h3 id="git-远程操作">Git 远程操作</h3>
<h4 id="git-remote">git remote</h4>
<p>不带选项的时候， <code>git remote </code>命令列出所有远程主机</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git remote
</span></span><span class="line"><span class="cl">origin</span></span></code></pre></div></div>
<p>使用<code>-v</code>选项，可以参看远程主机的网址。</p>
<p>克隆版本库的时候，所使用的远程主机自动被 Git 命名为 <code>origin</code> 。若想用其他的主机名，需要用 <code>git clone </code>命令的 <code>-o</code> 选项指定</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shel">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ git clone -o jQuery https://github.com/jquery/jquery.git
</span></span><span class="line"><span class="cl">$ git remote
</span></span><span class="line"><span class="cl">jQuery</span></span></code></pre></div></div>
<p>查看该主机的详细信息</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git remote show &lt;主机名&gt;</span></span></code></pre></div></div>
<p>添加远程主机</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git remote add &lt;主机名&gt; &lt;网址/SSH&gt;</span></span></code></pre></div></div>
<p>删除远程主机</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git remote rm &lt;主机名&gt;</span></span></code></pre></div></div>
<p>远程主机改名</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git remote rename &lt;原主机名&gt; &lt;新主机名&gt;</span></span></code></pre></div></div>
<h4 id="git-fetch">git fetch</h4>
<p>默认情况下， <code>git fetch </code>取回所有分支（branch）的更新。若只想取回特定分支的更新，可以指定分支名。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git fetch &lt;远程主机名&gt; &lt;分支名&gt;</span></span></code></pre></div></div>
<p><code>git branch </code>命令的 <code>-r</code> 选项，可以用来查看远程分支， <code>-a</code> 选项查看所有分支。</p>
<p>所取回的更新，在本地主机上要用「远程主机名/分支名」的形式读取。取回远程主机的更新以后，可以在它的基础上，使用 <code>git checkout</code> 命令创建一个新的分支。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git checkout -b newBrach origin/master</span></span></code></pre></div></div>
<p>此外，也可以使用 <code>git merge</code> 命令或者 <code>git rebase</code> 命令，在本地分支上合并远程分支。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git merge origin/master
</span></span><span class="line"><span class="cl"><span class="c1"># 或者</span>
</span></span><span class="line"><span class="cl">$ git rebase origin/master</span></span></code></pre></div></div>
<h4 id="git-pull">git pull</h4>
<p><code>git pull </code>命令的作用是，取回远程主机某个分支的更新，再与本地的指定分支合并。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git pull &lt;远程主机名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt;
</span></span><span class="line"><span class="cl"><span class="c1"># 同于</span>
</span></span><span class="line"><span class="cl">$ git fetch &lt;远程主机名&gt;
</span></span><span class="line"><span class="cl">$ git merge &lt;远程主机名&gt;/&lt;远程分支名&gt;</span></span></code></pre></div></div>
<p>如果远程分支是与当前分支合并，则冒号后面的部分可以省略。</p>
<p>如果合并需要采用 rebase 模式，可以使用 <code>--rebase</code> 选项。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git pull --rebase &lt;远程主机名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt;</span></span></code></pre></div></div>
<p>如果远程主机删除了某个分支，默认情况下，<code>git pull</code> 不会在拉取远程分支的时候删除对应的本地分支。这是为了防止，由于其他人操作了远程主机，导致 <code>git pull</code> 不知不觉删除了本地分支。加上参数 <code>-p</code> 就会在本地删除远程已经删除的分支。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git pull -p
</span></span><span class="line"><span class="cl"><span class="c1"># 等同于</span>
</span></span><span class="line"><span class="cl">$ git fetch --prune origin
</span></span><span class="line"><span class="cl">$ git fetch -p</span></span></code></pre></div></div>
<h4 id="git-push">git push</h4>
<p><code>git push</code> 命令用于将本地分支的更新，推送到远程主机。它的格式与 <code>git pull</code> 命令相仿。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;</span></span></code></pre></div></div>
<p><code>git push &lt;远程主机名&gt; &lt;本地分支名&gt;</code> ，将 <code>&lt;本地分支名&gt;</code> 本地分支推送到 <code>&lt;远程主机名&gt;</code> 主机的 <code>&lt;本地分支名&gt;</code> 分支。如果后者不存在，则会被新建。</p>
<p>如果省略本地分支名，则表示删除指定的远程分支，因为这等同于推送一个空的本地分支到远程分支。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git push origin :master
</span></span><span class="line"><span class="cl"><span class="c1"># 等同于</span>
</span></span><span class="line"><span class="cl">$ git push origin --delete master</span></span></code></pre></div></div>
<p>不带任何参数的 <code>git push</code> ，默认只推送当前分支，这叫做 simple 方式。此外，还有一种 matching 方式，会推送所有有对应的远程分支的本地分支。如果要修改这个设置，可以采用<code>git config</code>命令。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git config --global push.default matching</span></span></code></pre></div></div>
<p>还有一种情况，就是不管是否存在对应的远程分支，将本地的所有分支都推送到远程主机，这时需要使用 <code>--all</code> 选项。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git push --all origin</span></span></code></pre></div></div>
<p>上面命令表示，将所有本地分支都推送到 <code>origin</code> 主机。</p>
<p>如果远程主机的版本比本地版本更新，推送时 Git 会报错，要求先在本地做 <code>git pull</code> 合并差异，然后再推送到远程主机。这时，如果你一定要推送，可以使用 <code>--force</code> 选项。</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-javascript">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">$</span> <span class="nx">git</span> <span class="nx">push</span> <span class="o">--</span><span class="nx">force</span> <span class="nx">origin</span></span></span></code></pre></div></div>
<p>上面命令使用 <code>--force</code> 选项，结果导致远程主机上更新的版本被覆盖。除非你很确定要这样做，否则应该尽量避免使用 <code>--force</code> 选项。</p>
<h2 id="标签管理">标签管理</h2>
<p>发布一个版本时，通常先在版本库中打一个标签（tag）（指向某个 commit 的指针），这样就唯一确定了打标签时刻的版本，即标签是版本库的一个快照。</p>
<h3 id="创建标签">创建标签</h3>
<p>切换到需要打标签的分支上，再打标签</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git tag v1.0</span></span></code></pre></div></div>
<p>默认标签是打在最新提交的 commit 上，但有时也会忘记，方法是找到历史提交的 commit id，然后打上标签</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git tag v0.9 f1e08</span></span></code></pre></div></div>
<p>再用命令 <code>git tag</code> 查看标签，标签按字母排序</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git tag
</span></span><span class="line"><span class="cl">v0.9
</span></span><span class="line"><span class="cl">v1.0</span></span></code></pre></div></div>
<p>可以用 <code>git show &lt;tagname&gt;</code> 查看标签信息</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git show v0.9
</span></span><span class="line"><span class="cl">commit f1e08437318d1e871680120c95bdcecb05a56b68 <span class="o">(</span>tag: v0.9<span class="o">)</span>
</span></span><span class="line"><span class="cl">Author: &lt;user.name&gt; &lt;&lt;user.emali&gt;&gt;
</span></span><span class="line"><span class="cl">Date:   Sat Apr <span class="m">6</span> 16:14:10 <span class="m">2019</span> +0800
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    add merge
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">diff --git a/README.md b/README.md
</span></span><span class="line"><span class="cl">...</span></span></code></pre></div></div>
<p>还可以创建带有说明的标签，用 <code>-a</code> 指定标签名， <code>-m</code> 指定说明文字</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git tag -a v0.1 -m <span class="s2">&#34;version 0.1 released&#34;</span> 45f6a</span></span></code></pre></div></div>
<p>标签总是和某个 commit 挂钩。若这个 commit 既出现在 master 分支，又出现在 dev 分支，那么在这两个分支上都会看到这个标签。</p>
<h3 id="操作标签">操作标签</h3>
<p>若标签打错了，也可以删除</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git tag -d v0.1
</span></span><span class="line"><span class="cl">Deleted tag <span class="s1">&#39;v0.1&#39;</span> <span class="o">(</span>was 45f6ab3<span class="o">)</span></span></span></code></pre></div></div>
<p>若要推送某个标签到远程，使用命令 <code>git push origin &lt;tagname&gt;</code></p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git push origin v1.0
</span></span><span class="line"><span class="cl">Total <span class="m">0</span> <span class="o">(</span>delta 0<span class="o">)</span>, reused <span class="m">0</span> <span class="o">(</span>delta 0<span class="o">)</span>
</span></span><span class="line"><span class="cl">To github.com:&lt;github username&gt;/&lt;repository&gt;.git
</span></span><span class="line"><span class="cl"> * <span class="o">[</span>new tag<span class="o">]</span>         v1.0 -&gt; v1.0</span></span></code></pre></div></div>
<p>也可以一次性推送全部尚未推送到远程的本地标签， <code>git push origin --tags</code></p>
<p>若标签已经推送到远程，要删除远程标签就要删除， <code>git tag -d v0.9</code> ，再从远程删除， <code>git push origin :refs/tags/v0.9</code> 。</p>
<h2 id="其他-git-技巧">其他 Git 技巧</h2>
<h3 id="配置别名">配置别名</h3>
<p>若用 <code>st</code> 表示 <code>status</code> ，可以为 <code>status</code> 配置别名， <code>git config --global alias.st status</code> 。</p>
<p><code>git config --global alias.unstage 'reset HEAD'</code> ，自定义撤销暂存区的修改操作。</p>
<p>更有甚者，<code>git config --global alias.lg &quot;log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit&quot;</code> 。</p>
<p>每个仓库的 Git 配置文件都放在 <code>.git/config</code> 文件中，当前用户的 Git 配置文件放在用户主目录下 <code>.gitconfig</code> 文件中，删除配置别名可以直接删除在 Git 配置文件对应的行</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[alias]
</span></span><span class="line"><span class="cl">    st = status
</span></span><span class="line"><span class="cl">    unstage = reset HEAD</span></span></code></pre></div></div>
<p>此外</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 显示当前的Git配置</span>
</span></span><span class="line"><span class="cl">$ git config --list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 编辑Git配置文件</span>
</span></span><span class="line"><span class="cl">$ git config -e <span class="o">[</span>--global<span class="o">]</span></span></span></code></pre></div></div>
<h3 id="搭建-git-服务器">搭建 Git 服务器</h3>
<p>远程仓库实际上和本地仓库没啥不同，只是一直保持开机并供小伙伴交换修改。</p>
<p>搭建 Git 服务器需要准备一台运行 Linux 的机器，强烈推荐用 Ubuntu 或 Debian，这样通过几条简单的 <code>apt</code> 命令就可以完成安装。</p>
<ol>
<li>
<p>安装 <code>git</code> ： <code>sudo apt-get install git</code></p>
</li>
<li>
<p>创建一个 <code>git</code> 用户，用来运行 <code>git</code> 服务： <code>sudo adduser git</code></p>
</li>
<li>
<p>创建证书登录：收集所有需要登录的用户的公钥，即 <code>id_rsa.pub</code> 文件，把所有公钥导入到 <code>/home/git/.ssh/authorized_keys</code> 文件里，一行一个</p>
</li>
<li>
<p>初始化 Git 仓库：先选定一个目录作为 Git 仓库（服务器上的 Git 仓 库通常都以 <code>.git</code> 结尾），输入 <code>sudo git init --bare sample.git</code> ，Git 会创建一个裸仓库，没有工作区</p>
</li>
<li>
<p>把 owner 改为 <code>git</code> ： <code>sudo chown -R git:git sample.git</code></p>
</li>
<li>
<p>禁用 shell 登录：出于安全考虑，第二步创建的 <code>git</code> 用户不允许登录 shell，可以通过编辑 <code>/etc/passwd</code> 文件完成，找到类似下面的一行：</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git:x:1001:1001:,,,:/home/git:/bin/bash</span></span></code></pre></div></div>
<p>改为</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git:x:1001:1001:,,,:/home/git:/usr/bin/git-shell</span></span></code></pre></div></div>
<p>这样，git 用户可以正常通过 ssh 使用 git，但无法登录 shell，因为 git 用户指定的 git-shell 每次一登录就自动退出。</p>
</li>
<li>
<p>克隆远程仓库：现在可以通过 <code>git clone</code> 命令克隆远程仓库， <code>git clone git@server:.../sample.git</code></p>
</li>
</ol>
<p>另：</p>
<ul>
<li>要管理公钥，用 <a href="https://github.com/sitaramc/gitolite" target="_blank" rel="noopener noreffer ">Gitosis</a></li>
<li>要控制权限，用 <a href="https://github.com/sitaramc/gitolite" target="_blank" rel="noopener noreffer ">Gitolite</a></li>
</ul>
<h2 id="ref">Ref</h2>
<ul>
<li><a href="https://git-scm.com/" target="_blank" rel="noopener noreffer ">Git</a></li>
<li><a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="noopener noreffer ">Git 教程 - 廖雪峰的官方网站</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2014/06/git_remote.html" target="_blank" rel="noopener noreffer ">Git 远程操作详解 - 阮一峰的网络日志</a></li>
<li><a href="http://gityuan.com/2015/06/27/git-notes/" target="_blank" rel="noopener noreffer ">Git 常用命令 - Gityuan 博客 | 袁辉辉的 Android 博客</a></li>
</ul>
<h2 id="changelog">ChangeLog</h2>
<ul>
<li>2019.04.07 贴上阮一峰关于 Git 博客链接，供下次学习</li>
<li>2019.04.06 学习廖雪峰 Git 教程的笔记</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2019-04-06</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/2019-03-26-git/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on X" data-sharer="x" data-url="https://austinxt.github.io/2019-03-26-git/" data-title="Git 使用指南" data-hashtags="Git"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Threads" data-sharer="threads" data-url="https://austinxt.github.io/2019-03-26-git/" data-title="Git 使用指南"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://austinxt.github.io/2019-03-26-git/" data-hashtag="Git"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://austinxt.github.io/2019-03-26-git/" data-title="Git 使用指南"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://austinxt.github.io/2019-03-26-git/" data-title="Git 使用指南"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@14.9.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://austinxt.github.io/2019-03-26-git/" data-title="Git 使用指南"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Diaspora" data-sharer="diaspora" data-url="https://austinxt.github.io/2019-03-26-git/" data-title="Git 使用指南" data-description=""><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=https%3a%2f%2faustinxt.github.io%2f2019-03-26-git%2f&amp;text=Git%20%e4%bd%bf%e7%94%a8%e6%8c%87%e5%8d%97" target="_blank" title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/git/">Git</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2019-04-06-deploy-django/" class="prev" rel="prev" title="阿里云从零部署 Django"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>阿里云从零部署 Django</a>
            <a href="/2019-07-15-cancer-history/" class="next" rel="next" title="一窥癌症：人类扭曲态">一窥癌症：人类扭曲态<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.148.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.nightvoyager.top/" target="_blank">夜航星</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.2/sharer.min.js"></script><script>window.config={"comment":{}};</script><script src="/js/theme.min.js"></script></body>
</html>
