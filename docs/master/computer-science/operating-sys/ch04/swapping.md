# 对换

按照每次对换的数量，分为整体（中级）对换和页面（分段）对换。

## 对换区的管理

在具有对换功能的 OS 中，通常把磁盘空间分为文件区和对换区。文件区管理的目标是提高文件存储空间的利用率，采用离散分配方式；对换区管理的目标是提高进程换入和换出的速度，采取连续分配方式。

对换区空闲盘块管理的数据结构与内存动态分区分配方式所用的数据结构相似；分配和回收操作也与动态分区的内存分配和回收相似。

## 进程的换出与换入

目前使用较多的对换方案是，在处理机正常运行时不启动对换程序，发现有许多进程在运行时经常发生缺页且显现出内存紧张的情况时才启动对换程序，将一部分进程调至外存（发现所有进程缺页率都明显减少时且系统吞吐量已下降时，可暂停对换程序）。

### 进程换出

- 选择被换出的进程：检查所有驻留在内存中的进程，优先选择处于阻塞或睡眠状态的进程、优先级低的进程、驻留时间长的进程。
- 进程换出过程：只能换出非共享的程序和数据段，换出前要申请对换空间，启动对换后，若传送进程未出现错误，便可回收该进程所占用的内存空间，并修改该进程的进程控制块和内存分配表等数据结构。

### 进程换入

先查看 PCB 集合中所有进程的状态，先找作为「就绪状态」被换出的进程，被换出时间久的进程优先换入。换入时要先申请内存，申请成功则直接将进程从外存调入内存；否则需先将内存中的某些进程换出，腾出足够的空间再调入。

## ChangeLog

> 2018.09.11 初稿

